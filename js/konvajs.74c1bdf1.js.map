{"version":3,"sources":["webpack:///./src/modules/konvajs/index.vue","webpack:///src/modules/konvajs/index.vue","webpack:///./src/modules/konvajs/index.vue?cb4d","webpack:///./src/modules/konvajs/index.vue?1df2","webpack:///./src/modules/konvajs/cake.jpg"],"names":["_c","_self","attrs","on","_vm","staticStyle","handleStageMouseDown","key","item","name","staticRenderFns","width","window","innerWidth","height","innerHeight","image","Image","src","require","data","stageSize","selectedShapeName","shapeList","type","draggable","text","x","y","fontSize","fill","radius","stroke","scaleX","scaleY","rotation","points","strokeWidth","methods","writeMessage","message","shape","find","handleStageMouseOut","handleStageMouseMove","mousePos","$refs","stage","getNode","getPointerPosition","e","target","getStage","updateTransformer","clickedOnTransformer","getParent","className","transformerNode","transformer","selectedNode","findOne","node","nodes","handleAdd","push","Date","valueOf","handleDelete","filter","component","module","exports"],"mappings":"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","file":"js/konvajs.74c1bdf1.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[[_c('portal',{attrs:{\"to\":\"app-header\"}},[_c('v-btn',{staticClass:\"mr-2\",on:{\"click\":function($event){return _vm.handleAdd()}}},[_vm._v(\" 线 \")]),_c('v-btn',{staticClass:\"mr-2\",on:{\"click\":function($event){return _vm.handleAdd('box')}}},[_vm._v(\" 框 \")]),_c('v-btn',{staticClass:\"mr-2\",on:{\"click\":function($event){return _vm.handleAdd('image')}}},[_vm._v(\" 图片 \")]),_c('v-btn',{staticClass:\"mr-2\",on:{\"click\":function($event){return _vm.handleDelete(_vm.selectedShapeName)}}},[_vm._v(\" 删除 \")]),_c('a',{staticClass:\"mr-2\",attrs:{\"href\":\"javascript:location.reload()\"}},[_vm._v(\"Reload\")])],1)],[_c('v-stage',{ref:\"stage\",staticStyle:{\"border\":\"1px solid\"},attrs:{\"config\":_vm.stageSize},on:{\"mousemove\":_vm.handleStageMouseMove,\"mouseout\":_vm.handleStageMouseOut,\"mousedown\":_vm.handleStageMouseDown,\"touchstart\":_vm.handleStageMouseDown}},[_c('v-layer',[_vm._l((_vm.shapeList.filter(item => item.type === 'image')),function(item){return _c('v-image',{key:item.name,attrs:{\"config\":item}})}),_vm._l((_vm.shapeList.filter(item => item.type === 'circle')),function(item){return _c('v-circle',{key:item.name,attrs:{\"config\":item}})}),_vm._l((_vm.shapeList.filter(item => item.type === 'rect')),function(item){return _c('v-rect',{key:item.name,attrs:{\"config\":item}})}),_vm._l((_vm.shapeList.filter(item => item.type === 'line')),function(item){return _c('v-line',{key:item.name,attrs:{\"config\":item}})}),_vm._l((_vm.shapeList.filter(item => item.type === 'text')),function(item){return _c('v-text',{key:item.name,attrs:{\"config\":item}})}),_c('v-transformer',{ref:\"transformer\"})],2)],1),_c('div',[_vm._v(\" 外面 \")])]],2)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <template>\n      <portal to=\"app-header\">\n        <v-btn\n          class=\"mr-2\"\n          @click=\"handleAdd()\"\n        >\n          线\n        </v-btn>\n        <v-btn\n          class=\"mr-2\"\n          @click=\"handleAdd('box')\"\n        >\n          框\n        </v-btn>\n        <v-btn\n          class=\"mr-2\"\n          @click=\"handleAdd('image')\"\n        >\n          图片\n        </v-btn>\n        <v-btn\n          class=\"mr-2\"\n          @click=\"handleDelete(selectedShapeName)\"\n        >\n          删除\n        </v-btn>\n        <a\n          class=\"mr-2\"\n          href=\"javascript:location.reload()\"\n        >Reload</a>\n      </portal>\n    </template>\n    <template>\n      <v-stage\n        ref=\"stage\"\n        :config=\"stageSize\"\n        style=\"border: 1px solid;\"\n        @mousemove=\"handleStageMouseMove\"\n        @mouseout=\"handleStageMouseOut\"\n        @mousedown=\"handleStageMouseDown\"\n        @touchstart=\"handleStageMouseDown\"\n      >\n        <v-layer>\n          <v-image\n            v-for=\"item in shapeList.filter(item => item.type === 'image')\"\n            :key=\"item.name\"\n            :config=\"item\"\n          />\n          <v-circle\n            v-for=\"item in shapeList.filter(item => item.type === 'circle')\"\n            :key=\"item.name\"\n            :config=\"item\"\n          />\n          <v-rect\n            v-for=\"item in shapeList.filter(item => item.type === 'rect')\"\n            :key=\"item.name\"\n            :config=\"item\"\n          />\n          <v-line\n            v-for=\"item in shapeList.filter(item => item.type === 'line')\"\n            :key=\"item.name\"\n            :config=\"item\"\n          />\n          <v-text\n            v-for=\"item in shapeList.filter(item => item.type === 'text')\"\n            :key=\"item.name\"\n            :config=\"item\"\n          />\n          <v-transformer ref=\"transformer\" />\n        </v-layer>\n      </v-stage>\n      <div>\n        外面\n      </div>\n    </template>\n  </div>\n</template>\n\n<script>\nconst width = window.innerWidth;\nconst height = window.innerHeight;\n\nconst image = new window.Image();\nimage.src = require(\"./cake.jpg\");\n\nexport default {\n  data() {\n    return {\n      stageSize: {\n        width: width,\n        height: height - 100\n      },\n      image: image,\n      selectedShapeName:'',\n      shapeList: [\n        { type: 'text', name: 'mytext', draggable: true,text: 'hello', x: 100, y: 10, fontSize: 20, fill: 'tomato'},\n        { type: 'text',name: 'text', draggable: true,text: '里面', y: 10, fontSize: 20, fill: 'purple'},\n        { type: 'circle',name: 'circle', draggable: true, x: 100, y: 100, radius: 50, fill: 'tomato' },\n        { type: 'rect',name: 'rect', draggable: true, x: 100, y: 100, width: 100, height: 50, stroke: 'black' },\n        { type: 'image', name: 'image', draggable: true, x: 200, y: 100, image: image, scaleX: 1, scaleY: 1,rotation: 0,},\n        { type: 'line', name: 'line', draggable: true, x: 100, y: 100, points: [0, 0, 150, -30], stroke: 'green', strokeWidth: 15 },\n        { type: 'line', name: 'line1', draggable: true, x: 200, y: 100, points: [0, 0, 150, 100], stroke: 'orange', strokeWidth: 15 },\n      ],\n    };\n  },\n\n  methods: {\n    writeMessage(message) {\n      // 更新mytext\n      const shape = this.shapeList.find((item) => item.name === 'mytext');\n      if (shape){ shape.text = message;}\n    },\n    handleStageMouseOut() {\n      this.writeMessage('Mouseout Stage');\n    },\n    handleStageMouseMove() {\n      const mousePos = this.$refs.stage.getNode().getPointerPosition();\n      const x = mousePos.x;\n      const y = mousePos.y;\n      this.writeMessage('x: ' + x + ', y: ' + y);\n    },\n    handleStageMouseDown(e) {\n      this.writeMessage('Click Stage');\n      // console.log('handleStageMouseDown', e);\n\n      // clicked on stage - clear selection\n      if (e.target === e.target.getStage()) {\n        this.selectedShapeName = '';\n        this.updateTransformer();\n        return;\n      }\n\n      // clicked on transformer - do nothing\n      const clickedOnTransformer =\n        e.target.getParent().className === 'Transformer';\n      if (clickedOnTransformer) {\n        return;\n      }\n\n      // find clicked rect by its name\n      const name = e.target.name();\n      // const rect = this.rectangles.find((r) => r.name === name);\n      if (name) {\n        this.selectedShapeName = name;\n      } else {\n        this.selectedShapeName = '';\n      }\n      this.updateTransformer();\n    },\n    updateTransformer() {\n      // here we need to manually attach or detach Transformer node\n      const transformerNode = this.$refs.transformer.getNode();\n      const stage = transformerNode.getStage();\n      const { selectedShapeName } = this;\n\n      const selectedNode = stage.findOne('.' + selectedShapeName);\n      // do nothing if selected node is already attached\n      if (selectedNode === transformerNode.node()) {\n        return;\n      }\n\n      if (selectedNode) {\n        // attach to another node\n        transformerNode.nodes([selectedNode]);\n      } else {\n        // remove transformer\n        transformerNode.nodes([]);\n      }\n    },\n    handleAdd(type = 'line') {\n      if (type === 'line') {\n        this.writeMessage('Add line');\n        this.shapeList.push({ type: 'line', name: `${new Date().valueOf()}`, draggable: true, x: 0, y: 20, points: [0, 0, 150, 0], stroke: 'black', strokeWidth: 15 });\n      }\n      if (type === 'box') {\n        this.writeMessage('Add Box');\n        this.shapeList.push({ type: 'rect', name: `${new Date().valueOf()}`, draggable: true,x: 0, y: 0, width: 100, height: 50, stroke: 'black' });\n      }\n      if (type === 'image') {\n        this.writeMessage('Add image');\n        this.shapeList.push({ type: 'image', name: `${new Date().valueOf()}`, draggable: true, x: 0, y: 0, image: image, scaleX: 1, scaleY: 1,rotation: 0,});\n      }\n    },\n    handleDelete(name) {\n      if (name) {\n        this.writeMessage('Delete ' + name);\n        this.shapeList = this.shapeList.filter((item) => item.name !== name);\n        this.selectedShapeName = '';\n      }\n    }\n  }\n};\n</script>\n\n<style>\n\n</style>","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=47131ad7\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","module.exports = __webpack_public_path__ + \"img/cake.b93062bf.jpg\";"],"sourceRoot":""}