{"version":3,"sources":["webpack:///./src/modules/aggridexport/index.vue","webpack:///src/modules/aggridexport/index.vue","webpack:///./src/modules/aggridexport/index.vue?ee21","webpack:///./src/modules/aggridexport/index.vue?68c2","webpack:///./src/modules/aggridexport/index.vue?1e52"],"names":["_c","_self","staticClass","on","staticStyle","attrs","_vm","staticRenderFns","render","LicenseManager","setLicenseKey","components","AgGridVue","data","columnDefs","field","cellClass","excelStyles","id","dataType","rowData","name","desc","number","text","gridOptions","defaultColDef","sortable","filter","resizable","methods","onFirstDataRendered","params","gridApi","api","gridColumnApi","columnApi","exportToExcel","exportDataAsExcel","exportToCsv","exportDataAsCsv","component"],"mappings":"uIAA4CA,EAAOC,WAAS,MAAU,KAAmBC,UAAY,G,OAAU,mB,YAAS,O,GAAiB,CAA0B,kBAAC,4BAAiEC,CAAE,EAAC,oC,YAAS,O,GAAiB,CAAwB,kBAAC,0BAAgFC,2BAAY,iB,YAAU,kBAAM,YAAC,CAACC,OAAM,Q,MAA8B,CAAuB,cAAc,EAAI,WAAa,aAAeC,QAAgB,6BAAG,eAAC,eAA8C,IAAIN,sBAAe,yBAEnkBO,SAAe,GAAG,0BAAY,iHAAcP,EAAe,YAAC,MAAU,KAAoFK,EAAK,EAAC,S,OAAC,EAAM,IAAC,6EAAoE,OAAIC,KAAO,uEAG3P,GAASE,+E,wBCkCTC,OAAAC,cAAA,mTAEe,OACfC,WAAA,CACAC,0BAEAC,OACA,OACAC,WAAA,CACA,CAAAC,MAAA,QACA,CAAAA,MAAA,QACA,CACAA,MAAA,SACAC,UAAA,cAMA,CACAD,MAAA,OACAC,UAAA,eAGAC,YAAA,CACA,CACAC,GAAA,aACAC,SAAA,WAGAC,QAAA,CACA,CAAAC,KAAA,OAAAC,KAAA,GAAAC,OAAA,KAAAC,KAAA,8BACA,CAAAH,KAAA,SAAAC,KAAA,GAAAC,OAAA,gBAAAC,KAAA,IACA,CAAAH,KAAA,SAAAC,KAAA,GAAAC,OAAA,KAAAC,KAAA,iCACA,CAAAH,KAAA,QAAAC,KAAA,MAAAC,OAAA,gBAAAC,KAAA,oBACA,CAAAH,KAAA,QAAAC,KAAA,MAAAC,QAAA,iBAAAC,KAAA,qBACA,CAAAH,KAAA,OAAAC,KAAA,MAAAC,OAAA,iBAAAC,KAAA,oBACA,CAAAH,KAAA,SAAAC,KAAA,MAAAC,OAAA,iBAAAC,KAAA,oBACA,CAAAH,KAAA,QAAAC,KAAA,MAAAC,OAAA,iBAAAC,KAAA,qBACA,CAAAH,KAAA,QAAAC,KAAA,MAAAC,OAAA,kBAAAC,KAAA,sBACA,CAAAH,KAAA,QAAAC,KAAA,MAAAC,OAAA,mBAAAC,KAAA,wBACA,CAAAH,KAAA,QAAAC,KAAA,MAAAC,OAAA,mBAAAC,KAAA,wBACA,CAAAH,KAAA,QAAAC,KAAA,MAAAC,OAAA,oBAAAC,KAAA,yBACA,CAAAH,KAAA,QAAAC,KAAA,MAAAC,OAAA,qBAAAC,KAAA,mCAEAC,YAAA,CACAC,cAAA,CACAC,UAAA,EACAC,QAAA,EACAC,WAAA,MAKAC,QAAA,CACAC,oBAAAC,GACA,KAAAC,QAAAD,EAAAE,IACA,KAAAC,cAAAH,EAAAI,WAEAC,gBACA,KAAAJ,QAAAK,qBAEAC,cACA,KAAAN,QAAAO,qBCtG2X,I,wBCQvXC,EAAY,eACd,EACA,EACAlC,GACA,EACA,KACA,WACA,MAIa,aAAAkC,E,kECnBf","file":"js/aggridexport.52891ba2.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('v-btn',{staticClass:\"ma-2\",on:{\"click\":function($event){return _vm.exportToExcel()}}},[_vm._v(\" Export to Excel \")]),_c('v-btn',{staticClass:\"ma-2\",on:{\"click\":function($event){return _vm.exportToCsv()}}},[_vm._v(\" Export to Csv \")]),_c('ag-grid-vue',{staticClass:\"ag-theme-alpine\",staticStyle:{\"height\":\"65vh\"},attrs:{\"column-defs\":_vm.columnDefs,\"row-data\":_vm.rowData,\"grid-options\":_vm.gridOptions,\"excel-styles\":_vm.excelStyles},on:{\"first-data-rendered\":_vm.onFirstDataRendered}}),_c('p',[_vm._v(\"对于长数字 csv数字转为字符串就没问题\")]),_c('p',[_vm._v(\"整数位数字多于21位已经超出了 JavaScript 精确整数范围 ?9007199254740992 至 9007199254740992 （即正负2的53次方）\")]),_vm._m(0)],1)\n}\nvar staticRenderFns = [function (){var _vm=this,_c=_vm._self._c;return _c('p',[_vm._v(\" 导出的excel为科学记数法，要修改为cellClass的dataType: 'String',然后再导出 参考文档 \"),_c('a',{attrs:{\"href\":\"https://www.ag-grid.com/angular-data-grid/excel-export-data-types/\"}},[_vm._v(\"https://www.ag-grid.com/angular-data-grid/excel-export-data-types/\")])])\n}]\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <v-btn\n      class=\"ma-2\"\n      @click=\"exportToExcel()\"\n    >\n      Export to Excel\n    </v-btn>\n    <v-btn\n      class=\"ma-2\"\n      @click=\"exportToCsv()\"\n    >\n      Export to Csv\n    </v-btn>\n    <ag-grid-vue\n      style=\"height: 65vh;\"\n      class=\"ag-theme-alpine\"\n      :column-defs=\"columnDefs\"\n      :row-data=\"rowData\"\n      :grid-options=\"gridOptions\"\n      :excel-styles=\"excelStyles\"\n      @first-data-rendered=\"onFirstDataRendered\"\n    />\n    <p>对于长数字 csv数字转为字符串就没问题</p>\n    <p>整数位数字多于21位已经超出了 JavaScript 精确整数范围 ?9007199254740992 至 9007199254740992 （即正负2的53次方）</p>\n    <p>\n      导出的excel为科学记数法，要修改为cellClass的dataType: 'String',然后再导出\n      参考文档 <a\n        href=\"https://www.ag-grid.com/angular-data-grid/excel-export-data-types/\"\n      >https://www.ag-grid.com/angular-data-grid/excel-export-data-types/</a>\n    </p>\n  </div>\n</template>\n\n<script>\nimport { LicenseManager } from 'ag-grid-enterprise';\nimport { AgGridVue } from 'ag-grid-vue';\n\n// 挖槽 不去注册的话，exportDataAsExcel不能用\nLicenseManager.setLicenseKey('CompanyName=Suzhou ruhlamat Smart Technologies Co., Ltd.,LicensedApplication=Infinity,LicenseType=SingleApplication,LicensedConcurrentDeveloperCount=1,LicensedProductionInstancesCount=30,AssetReference=AG-030422,SupportServicesEnd=30_August_2023_[v2]_MTY5MzM1MDAwMDAwMA==28423dd515d527503fc5a257dc86a8ac');\n\nexport default {\n  components: {\n    AgGridVue,\n  },\n  data() {\n    return {\n      columnDefs: [\n        { field: 'name' },\n        { field: 'desc' },\n        {\n          field: 'number',\n          cellClass: 'stringType', // 配合excelStyles，这样导出的excel就不是科学计数了\n          // valueGetter: arg => { // 改变表格显示的文字\n          //   const num = arg.data.number;\n          //   return num.toString() + '\\t' + '@@@'\n          // },\n        },\n        {\n          field: 'text',\n          cellClass: 'stringType', // 配合excelStyles，这样导出的excel就不是科学计数了\n        },\n      ],\n      excelStyles: [\n        {\n          id: 'stringType',\n          dataType: 'String',\n        },\n      ],\n      rowData: [\n        { name: '一般整数', desc: '', number: 72000, text: '带中文数字123456789012334243433' },\n        { name: '测试带小数位', desc: '', number: 35000.231231231, text: '' },\n        { name: '带.00小数', desc: '', number: 32000.00, text: 'engnumber12345678901234567890' },\n        { name: '测试长整数', desc: '16位', number: 1234567890123456, text: '1234567890123456' },\n        { name: '极限-整数', desc: '16位', number: -9007199254740992, text: '-9007199254740992' },\n        { name: '极限整数', desc: '16位', number: 9007199254740992, text: '9007199254740992' },\n        { name: '极限整数+1', desc: '16位', number: 9007199254740993, text: '9007199254740993' },\n        { name: '测试长整数', desc: '17位', number: 12345678901234567, text: '12345678901234567' },\n        { name: '测试长整数', desc: '18位', number: 123456789012345678, text: '123456789012345678' },\n        { name: '测试长整数', desc: '19位', number: 1234567890123456789, text: '12345678901234567890' },\n        { name: '测试长整数', desc: '20位', number: 12345678901234567890, text: '12345678901234567890' },\n        { name: '测试长整数', desc: '21位', number: 123456789012345678901, text: '123456789012345678901' },\n        { name: '测试长整数', desc: '30位', number: 123456789012345678901234567890, text: '123456789012345678901234567890' },\n      ],\n      gridOptions: {\n        defaultColDef: {\n          sortable: true,\n          filter: true,\n          resizable: true,\n        },\n      },\n    };\n  },\n  methods: {\n    onFirstDataRendered(params) {\n      this.gridApi = params.api;\n      this.gridColumnApi = params.columnApi;\n    },\n    exportToExcel() {\n      this.gridApi.exportDataAsExcel();\n    },\n    exportToCsv() {\n      this.gridApi.exportDataAsCsv();\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"scss\">\n@import \"~ag-grid-community/styles/ag-grid.css\";\n@import \"~ag-grid-community/styles/ag-theme-alpine.css\";\n</style>\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=c328208e&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=c328208e&prod&scoped=true&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"c328208e\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=c328208e&prod&scoped=true&lang=scss\""],"sourceRoot":""}